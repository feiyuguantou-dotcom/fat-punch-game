<!--pages/test/test.wxml-->
<view class="page">
  <!-- æµ‹è¯•æ ‡é¢˜ -->
  <view class="header">
    <view class="header-icon">ğŸ¯</view>
    <view class="header-title">æµ‹æµ‹ä½ çš„æ¸£ç”·ç±»å‹</view>
    <view class="header-subtitle">5ä¸ªé—®é¢˜,æµ‹å‡ºä½ çš„å‰ä»»æ˜¯ä»€ä¹ˆç±»å‹</view>
  </view>

  <!-- è¿›åº¦æ¡ -->
  <view class="progress-bar" wx:if="{{currentStep < questions.length}}">
    <view class="progress-fill" style="width: {{progress}}%;"></view>
  </view>

  <!-- é—®é¢˜åŒºåŸŸ -->
  <view class="question-container" wx:if="{{currentStep < questions.length}}">
    <view class="question-number">é—®é¢˜ {{currentStep + 1}}/{{questions.length}}</view>
    <view class="question-text">{{questions[currentStep].question}}</view>

    <view class="options-list">
      <view
        class="option-item {{selectedOption === index ? 'selected' : ''}}"
        wx:for="{{questions[currentStep].options}}"
        wx:key="index"
        wx:for-index="index"
        wx:for-item="option"
        bindtap="selectOption"
        data-index="{{index}}"
      >
        <view class="option-label">{{option.label}}</view>
        <view class="option-text">{{option.text}}</view>
        <view class="option-check" wx:if="{{selectedOption === index}}">âœ“</view>
      </view>
    </view>

    <button class="next-btn" bindtap="nextQuestion" disabled="{{selectedOption === null}}">
      {{currentStep === questions.length - 1 ? 'æŸ¥çœ‹ç»“æœ' : 'ä¸‹ä¸€é¢˜'}}
    </button>
  </view>

  <!-- ç»“æœåŒºåŸŸ -->
  <view class="result-container" wx:if="{{currentStep === questions.length && testResult}}">
    <view class="result-icon">{{testResult.emoji}}</view>
    <view class="result-title">{{testResult.title}}</view>
    <view class="result-subtitle">{{testResult.subtitle}}</view>

    <view class="result-card">
      <view class="card-section">
        <view class="section-title">ä½ çš„æ¸£ç”·ç±»å‹</view>
        <view class="section-content">{{testResult.scumbagType}}</view>
      </view>

      <view class="card-section">
        <view class="section-title">ä½ çš„æ€§æ ¼</view>
        <view class="section-content">{{testResult.yourPersonality}}</view>
      </view>

      <view class="card-section">
        <view class="section-title">åŒ¹é…å»ºè®®</view>
        <view class="section-content">{{testResult.matchAdvice}}</view>
      </view>
    </view>

    <view class="action-buttons">
      <button class="action-btn primary" bindtap="playGame">
        <view class="btn-icon">ğŸ‘Š</view>
        <view class="btn-text">å»æä»–</view>
      </button>
      <button class="action-btn secondary" open-type="share">
        <view class="btn-icon">ğŸ“¤</view>
        <view class="btn-text">åˆ†äº«ç»“æœ</view>
      </button>
    </view>

    <button class="retry-btn" bindtap="retryTest">é‡æ–°æµ‹è¯•</button>
  </view>
</view>
